[{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"FLOW-MR-tutorial","text":"FLOW-MR R package performing Mendelian Randomization mediation setting. tutorial demonstrates use package step step.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"FLOW-MR-tutorial","text":"","code":"# Install devtools if not installed install.packages(\"devtools\") #>  #> The downloaded binary packages are in #>  /var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T//RtmpYVc0Jt/downloaded_packages  # Install FLOW-MR devtools::install_github(\"ZixuanWu1/FLOW-MR\") #> rlang        (1.1.4    -> 1.1.5   ) [CRAN] #> cli          (3.6.3    -> 3.6.4   ) [CRAN] #> pillar       (1.9.0    -> 1.10.1  ) [CRAN] #> R6           (2.5.1    -> 2.6.1   ) [CRAN] #> Rcpp         (1.0.13   -> 1.0.14  ) [CRAN] #> withr        (3.0.1    -> 3.0.2   ) [CRAN] #> gtable       (0.3.5    -> 0.3.6   ) [CRAN] #> RcppArmad... (14.0.2-1 -> 14.2.3-1) [CRAN] #>  #> The downloaded binary packages are in #>  /var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T//RtmpYVc0Jt/downloaded_packages #> ── R CMD build ───────────────────────────────────────────────────────────────── #> * checking for file ‘/private/var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T/RtmpYVc0Jt/remotes6e32145d8194/ZixuanWu1-FLOW-MR-2165c20/DESCRIPTION’ ... OK #> * preparing ‘FLOWMR’: #> * checking DESCRIPTION meta-information ... OK #> * cleaning src #> Warning: bad markup (extra space?) at BayesMediation.Rd:48:21 #> Warning: bad markup (extra space?) at BayesMediation.Rd:49:22 #> Warning: bad markup (extra space?) at BayesMediation.Rd:50:26 #> Warning: bad markup (extra space?) at BayesMediation.Rd:52:27 #> Warning: bad markup (extra space?) at BayesMediation.Rd:54:29 #> Warning: bad markup (extra space?) at BayesMediation.Rd:56:30 #> Warning: bad markup (extra space?) at BayesMediation.Rd:58:17 #> Warning: bad markup (extra space?) at BayesMediation.Rd:59:18 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:64:9 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:65:9 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:66:14 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:67:14 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:68:10 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:69:13 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:24:12 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:25:16 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:26:10 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:27:13 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:28:12 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:29:14 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:30:11 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:31:13 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:42:10 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:43:10 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:44:10 #> * installing the package to process help pages #> * saving partial Rd database #> * cleaning src #> * checking for LF line-endings in source and make files and shell scripts #> * checking for empty or unneeded directories #> * building ‘FLOWMR_1.0.tar.gz’"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"load-the-package","dir":"Articles","previous_headings":"","what":"Load the Package","title":"FLOW-MR-tutorial","text":"","code":"library(FLOWMR)"},{"path":[]},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-1-prepare-input-data","dir":"Articles","previous_headings":"Example Usage","what":"Step 1: Prepare Input Data","title":"FLOW-MR-tutorial","text":", use GRAPPLE preprocess input data. can download GRAPPLE package using following command: Next, use GRAPPLE preprocess data following three-sample Mendelian Randomization (MR) design. sel.file used select genome-wide significant SNPs, exp.file contains exposures interest, .file contains outcomes interest. details, visit GRAPPLE GitHub. example use adult BMI GIANT childhoood BMI EGG selections files. use childhood body size bmi adult UK biobank exposures, Breast Cancer paper outcome.","code":"devtools::install_github(\"jingshuw/grapple\") library(GRAPPLE)  # Selection file of snps sel.file <- c(\"~/Downloads/research/BMI-giant17eu.csv\", \"~/Downloads/research/bmi_child_egg.csv\" )  # Exposure file exp.file <- c( \"~/Downloads/research/childhood_bmi_nat_comm_2019_8years\",\"~/Downloads/research/BMI_adult.csv\" )  # Outcome file out.file <- \"~/Downloads/research/Breast-Micha17erp.csv\"  # Use plink to select independent significant SNPs plink_refdat <- \"~/Downloads/research/data_maf0.01_rs_ref/data_maf0.01_rs_ref\"  ## Use max.p.thres to decide the significance level of SNPs ## Use cal.cor = T to compute the noise correlation data.list <- GRAPPLE::getInput(sel.file, exp.file, out.file, plink_refdat, max.p.thres =1e-4,                                plink_exe = \"~/Downloads/research/plink_mac_20210606/plink\", cal.cor = T) #> [1] \"Marker candidates will not be obtained as number of risk factors k > 1\" #> [1] \"loading data for selection: ~/Downloads/research/BMI-giant17eu.csv ...\" #> [1] \"loading data for selection: ~/Downloads/research/bmi_child_egg.csv ...\" #> [1] \"loading data from exposure: ~/Downloads/research/childhood_bmi_nat_comm_2019_8years ...\" #> [1] \"loading data from exposure: ~/Downloads/research/BMI_adult.csv ...\" #> [1] \"loading data from outcome: ~/Downloads/research/Breast-Micha17erp.csv ...\" #> [1] \"Start clumping using PLINK ...\" #> [1] \"262 independent genetic instruments extracted. Done!\""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-2-run-flow-mr","dir":"Articles","previous_headings":"Example Usage","what":"Step 2: Run FLOW-MR","title":"FLOW-MR-tutorial","text":"run FLOW-MR, need prepare two input files, Gamma_hat Sd_hat. Also ensuring time order reversed: , can optionally provide cor_mat, K K matrix represents shared noise correlation GWAS summary statistics across traits. particularly useful GWAS summary statistics include overlapping samples. GRAPPLE estimates noise correlation first selecting non-significant SNPs (e.g., p-value > 0.5) computing correlation estimated effect sizes. default value diagonal matrix.","code":"dat <-data.list$data;  # Run the mediation method Gamma_hat =rbind(dat$gamma_out1,                   dat$gamma_exp2,                  dat$gamma_exp1)  Sd_hat = rbind(dat$se_out1,                 dat$se_exp2,                dat$se_exp1)  cor_mat = data.list$cor.mat[3:1, 3:1]  result = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat ) #> [1] \"2025-03-14 09:59:59 CDT\" #> [1] \"2025-03-14 10:00:33 CDT\""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-3-look-at-summary-of-direct-effects","dir":"Articles","previous_headings":"Example Usage","what":"Step 3: Look at summary of direct effects","title":"FLOW-MR-tutorial","text":"step, print summary direct effects, row corresponds parameter. summary, provide estimated posterior mean, variance, standard deviation, 2.5% quantile, median, 97.5% quantile, effective sample size (ESS), Gelman-Rubin Rhat statistic parameter. ESS quantifies number independent samples, Rhat (Gelman-Rubin statistic) assesses convergence. See ESS Rhat detailed explanations ESS Rhat. meaning parameter, B[l, k] represents effect kk-th latest trait ll-th latest trait. example: - B[1, 2] represents effect adult BMI breast cancer, - (B[1, 3] represents direct effect childhood BMI breast cancer, - (B[2, 3] represents direct effect childhood BMI adult BMI. meaning parameters, assume following priors manuscript: αkj∼(1−pk)N(0,σk02)+pkN(0,σk12) \\alpha_{kj} \\sim (1 - p_k)N(0, \\sigma_{k0}^2) + p_k N(0, \\sigma_{k1}^2) βkl∼N(0,σ2),l>k \\beta_{kl} \\sim N(0, \\sigma^2), \\quad l > k also include posterior summary parameters. summary: - sigma1[k] represents standard deviation slab component trait kk, - sigma0[k] represents standard deviation spike component trait kk, - p[k] represents proportion slab component, - \\sigma represents standard deviation BB. effects considered significant credible interval include 0. non-convergence issues arise (e.g., large Rhat value), can generate trace plot posterior samples using following command:","code":"print(result$summary) #>                   mean          var           sd         2.5%          50% #> B[1,2]    -0.003799960 1.499704e-02 0.1224623953 -0.242506035 -0.004762849 #> B[1,3]    -0.208916503 6.275352e-03 0.0792171177 -0.373170259 -0.207991179 #> B[2,3]     0.665471334 8.893716e-03 0.0943064996  0.501847350  0.659909168 #> sigma      0.421958927 1.197907e-02 0.1094489416  0.267911905  0.402421742 #> sigma1[1]  0.020422056 1.224979e-05 0.0034999697  0.014939265  0.019985341 #> sigma1[2]  0.027266894 7.479270e-05 0.0086482775  0.016470575  0.025459393 #> sigma1[3]  0.051531506 1.647916e-04 0.0128371172  0.032076821  0.049623151 #> sigma0[1]  0.004014919 9.450237e-07 0.0009721233  0.002465223  0.003908847 #> sigma0[2]  0.010903923 1.485353e-06 0.0012187504  0.008371434  0.010932066 #> sigma0[3]  0.015815887 3.905375e-06 0.0019762020  0.012244022  0.015725888 #> p[1]       0.201621997 4.761344e-03 0.0690024897  0.085769722  0.196063901 #> p[2]       0.034691299 8.198708e-04 0.0286333866  0.003505214  0.026866603 #> p[3]       0.045608505 4.713271e-04 0.0217100695  0.012394625  0.042635409 #>                  97.5%        ESS     Rhat #> B[1,2]     0.238086832  695.66401 1.002933 #> B[1,3]    -0.057080287  565.43372 1.005385 #> B[2,3]     0.856221073   56.94984 1.000525 #> sigma      0.689571449 4427.07302 1.004792 #> sigma1[1]  0.028565783 1249.14928 1.002086 #> sigma1[2]  0.049209360 3703.62082 1.000397 #> sigma1[3]  0.082478386 2669.62396 1.000203 #> sigma0[1]  0.006192147  261.61314 1.004128 #> sigma0[2]  0.013243683  487.88586 1.000888 #> sigma0[3]  0.020015323  640.43459 1.001528 #> p[1]       0.354793861  616.29918 1.009205 #> p[2]       0.109812666  878.61227 1.001145 #> p[3]       0.095434215 1667.64568 1.000631 FLOWMR::traceplot(result$raw, par = \"B\", ind = c(1,2))"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-4","dir":"Articles","previous_headings":"Example Usage","what":"Step 4","title":"FLOW-MR-tutorial","text":"estimate path-wise effects, use following command. example, code evaluates indirect effect childhood BMI breast cancer adult BMI:","code":"path_effect = indirect_effect(result$raw, K = 3, path = c(3,2,1),  warmup = 3000) print(path_effect) #>            Mean       2.5%          50%    97.5% #> 1 -7.288468e-05 -0.1631804 -0.003021919 0.177939"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"FLOW-MR-tutorial","text":"tutorial introduced key functionalities FLOW-MR. details, refer package documentation.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zixuan Wu. Author, maintainer. Ethan Lewis. Author. Qingyuan Zhao. Author. Jingshu Wang. Author.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wu Z, Lewis E, Zhao Q, Wang J (2024). “Causal mediation analysis time-varying heritable risk factors Mendelian Randomization.” bioRxiv, 2024–02.","code":"@Article{,   title = {Causal mediation analysis for time-varying heritable risk factors with Mendelian Randomization},   author = {Zixuan Wu and Ethan Lewis and Qingyuan Zhao and Jingshu Wang},   journal = {bioRxiv},   year = {2024},   pages = {2024--02},   publisher = {Cold Spring Harbor Laboratory}, }"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"flow-mr","dir":"","previous_headings":"","what":"An R Package for Mendelian Randomization in the mediation setting","title":"An R Package for Mendelian Randomization in the mediation setting","text":"R package FLOW-MR, Bayesian framework Mendelian Randomization mediation setting. details FLOW-MR framework, please refer manuscript. give brief description method. Check tutorial complete workflow.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"An R Package for Mendelian Randomization in the mediation setting","text":"run package, might need first install RCpp CRAN package can installed R Github repository:","code":"install.packages(\"RCpp\") library(devtools) install_github(\"ZixuanWu1/FLOW-MR\")"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic Usage","title":"An R Package for Mendelian Randomization in the mediation setting","text":"Recall Mediation setting, Γ=B̃⋅Γ+α\\Gamma = \\tilde{B} \\cdot \\Gamma + \\alpha  Γ\\Gamma matrix true SNP effects, B̃\\tilde{B} upper-triangular matrix zero diagonalsand α\\alpha horizontal pleiotropy. B̃\\tilde{B} represents matrix direct effects. One might equivalently write Γ=(+B)α\\Gamma = (+ {B}) \\alpha order run MrMediation, need least two inputs, Gamma_hat Sd_hat. Gamma_hat matrix observation Γ\\Gamma. Typically K×PK \\times P matrix KK number phenotypes PP number measured genetic variants. Sd_hat matrix matrix standard deviation noise dimension Gamma_hat. estimate matrix BB, one can use following command inv = TRUE implies estimating B̃\\tilde{B}, opposed estimating B{B} inv = FALSE. One can also support correlation among measurement errors setting cor correlation matrix addition, order compute indirect effect exposures outcome, one can simply use following command Sometimes might see warning algorithm might convergenced. problem solved using iterations changing initialization method. One can also look traceplot parameters MCMC diagnosis. instance, following function gives traceplot parameter insterest chains. (using B[1,2]B[1,2] example.)","code":"result = BayesMediation(Gamma_hat, Sd_hat, inv = TRUE) result_cor = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat, inv = TRUE) result = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat, indirect = T) traceplot(result$raw, par = \"B\", ind = c(1,2))"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":null,"dir":"Reference","previous_headings":"","what":"BayesMediation — BayesMediation","title":"BayesMediation — BayesMediation","text":"Bayes approach MR Mediation model.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BayesMediation — BayesMediation","text":"","code":"BayesMediation(   Gamma_hat,   Sd_hat,   init = \"Random\",   iter = 6000,   warmup = 3000,   second = F,   inv = FALSE,   cor = NULL,   Raw = T,   total = F,   indirect = F )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BayesMediation — BayesMediation","text":"Gamma_hat estimated exposure outcome effects gamma_hat Sd_hat standarded errors gamma_hat init Starting value gibbs sampler. Either \"Random\" \"EM\" iter number iterations gibbs sampler warmup length warm-periods second Whether run second stage. Default False. inv inv = False, estiming B Gamma = (+ B) alpha; inv = True, estimating B Gamma = B Gamma + alpha. cor correlation matrix noise. Raw Whether include unprocessed raw outputs. Default F total Whether include total effects. Default F indirect Whether include indirect effects. Default F.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"BayesMediation — BayesMediation","text":"list elements summary_first summary table first stage summary_second summary table second stage (included second  = T) total_effect_first total effect exposure outcome, computed first stage (included total = T) total_effect_second total effect exposure outcome, computed second stage (included total = T second = T) indirect_effect_first indirect effect exposure outcome, computed first stage (included indirect = T) indirect_effect_second indirect effect exposure outcome, computed second stage (included indirect = T  second = T) raw_first unprocessed output first stage (included raw= T) raw_second unprocessed output second stage (included raw = T second = T)","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"Bayesian framework Mendelian Randomization mediation setting.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"DESCRIPTION file: package yet installed build time.   Index:  package yet installed build time.  ~~ overview use package, including important functions ~~","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"Zixuan Wu [aut, cre],   Ethan Lewis [aut],   Qingyuan Zhao [aut],   Jingshu Wang [aut] Maintainer: Zixuan Wu <zixuanwu@uchicago.edu>","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"~~ Literature references background information ~~","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"","code":"# simple examples of the most important functions ~~"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"Model Y = (+B)+ noise","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"","code":"gibbs_sampler(   Y,   Sd_hat,   N,   B,   sigma,   sigma1,   sigma0,   p,   A,   Z,   alpha_B,   beta_B,   alpha_0,   alpha_1,   beta_0,   beta_1,   a,   b )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"Y KxP arma::matrix GWAS marginal associations Sd_hat KxP arma::matrix GWAS std errors N number samples obtain B initial value B arma::matrix sigma Initial value prior std deviation values B sigma1 K-arma::vector Initial values prior slab SDs trait's pleiotropy sigma0 K-arma::vector Initial values prior splike SDs trait's pleiotropy p K-arma::vector initial values p, slab probability mixture KxP arma::matrix initial values (ignored) Z KxP arma::matrix initial values Z (ignored), latent varaible indicating [,j] comes slab alpha_B Shape parameter InvGamma prior sigma (B) beta_B Scale parameter InvGamma prior sigma (B) alpha_0 K-arma::vector Shape parameter InvGamma prior sigma0 (Spike) alpha_1 K-arma::vector Shape parameter InvGamma prior sigma0 (Slab) beta_0 K-arma::vector Scale parameter InvGamma prior sigma0 (Spike) beta_1 K-arma::vector Scale parameter InvGamma prior sigma0 (Slab) K-arma::vector First parameter beta prior p b K-arma::vector Second parameter beta prior p","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"Model Y = (+B)+ noise","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"","code":"gibbs_sampler_with_corr(   Y,   Sd_hat,   trait_corr,   N,   B,   sigma,   sigma1,   sigma0,   p,   A,   Z,   alpha_B,   beta_B,   alpha_0,   alpha_1,   beta_0,   beta_1,   a,   b,   Lambda3,   Lambda_inv3 )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"Y KxP arma::matrix GWAS marginal associations Sd_hat KxP arma::matrix GWAS std errors trait_corr KxK arma::matrix correlation noises. N number samples obtain B initial value B arma::matrix sigma Initial value prior std deviation values B sigma1 K-arma::vector Initial values prior slab SDs trait's pleiotropy sigma0 K-arma::vector Initial values prior splike SDs trait's pleiotropy p K-arma::vector initial values p, slab probability mixture KxP arma::matrix initial values (ignored) Z KxP arma::matrix initial values Z (ignored), latent varaible indicating [,j] comes slab alpha_B Shape parameter InvGamma prior sigma (B) beta_B Scale parameter InvGamma prior sigma (B) alpha_0 K-arma::vector Shape parameter InvGamma prior sigma0 (Spike) alpha_1 K-arma::vector Shape parameter InvGamma prior sigma0 (Slab) beta_0 K-arma::vector Scale parameter InvGamma prior sigma0 (Spike) beta_1 K-arma::vector Scale parameter InvGamma prior sigma0 (Slab) K-arma::vector First parameter beta prior p b K-arma::vector Second parameter beta prior p Lambda3 Precomputed covariance matrix Lambda_inv3 Precomputed inverse covariance matrix","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Gibbs sampler — gibbs_wrapper","title":"Gibbs sampler — gibbs_wrapper","text":"Given observed effect standard error, run gibbs sampler draw samples posterior density","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gibbs sampler — gibbs_wrapper","text":"","code":"gibbs_wrapper(   N,   warmup,   chains = 4,   Gamma_hat,   Sd_hat,   sigma,   sigma_1,   sigma_0,   p,   parallel = TRUE,   init = \"Random\",   ratio = 10,   cor_mat = NULL,   Lambda = NULL,   Lambda_inv = NULL )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gibbs sampler — gibbs_wrapper","text":"N Number total iterations warmup Number warm-iterations. chains Number Chains. Gamma_hat observed effects Sd_hat standard deviation Gamma_hat sigma prior mean sigma sigma_1 prior mean sigma_1 sigma_0 prior mean sigma_0 p prior mean p parallel Indicating whether parallelly run chains. Default True. init Method Initialization. Must one \"EM\" \"Random\". Default \"Random\" ratio ratio initial sigma1 sigma0 initialization method \"Random\". Default 10. cor_mat correlation matrix noise. Default null (correlation) Lambda block diagonal matrix block covariance matrix noise SNP. Default NULL (provided) Lambda_inv block diagonal matrix block inverse covariance matrix noise SNP. Default NULL (provided).","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gibbs sampler — gibbs_wrapper","text":"list elements outputs chain. outputs list attributes B  p  sigma1  sigma0  pi  sigma","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Indirrect effedt — indirect_effect","title":"Indirrect effedt — indirect_effect","text":"Estimate indirrect effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Indirrect effedt — indirect_effect","text":"","code":"indirect_effect(   results,   K,   warmup = 3000,   path = NULL,   quantiles = c(0.025, 0.5, 0.975) )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Indirrect effedt — indirect_effect","text":"results results gibbs_wrapper K number phenotypes quantiles vector quantiles interests warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Indirrect effedt — indirect_effect","text":"matrix indirect effect quantiles.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/sigma_objective.html","id":null,"dir":"Reference","previous_headings":"","what":"The log likelihood function in the M-step — sigma_objective","title":"The log likelihood function in the M-step — sigma_objective","text":"log likelihood function M-step","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/sigma_objective.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The log likelihood function in the M-step — sigma_objective","text":"","code":"sigma_objective(sigma.sq, weights, values, std.errors)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"Produce summary table output gibbs_wrapper.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"","code":"summary_gibbs(result, pars, K, T = 1000, inv = FALSE)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"result output gibbs_wrapper gibbs_wrapper_cor pars vector parameters included summary table K number mediation layers T warmup period. Default 1000. inv inv TRUE, function shows summary statistics B Gamma = B Gamma + alpha, otherwise shows summary statistics B Gamma = (+ B) alpha. Default False","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"table row corresponds parameter. columns: mean average samples warm-variance variance samples warm-sd standard deviation samples warm-2.5% 2.5% quantile samples warm-50% 50  97.5% 97.5% quantile samples warm-ESS Effective sample sizes (combined chains) R_hat measure convergence. value 1.1 indicates sign convergence","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Total effect — total_effect","title":"Total effect — total_effect","text":"Estimate total effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Total effect — total_effect","text":"","code":"total_effect(results, K, warmup = 3000)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Total effect — total_effect","text":"results results gibbs_wrapper K number phenotypes warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Total effect — total_effect","text":"matrix total effect quantiles.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce traceplot for the specified parameter — traceplot","title":"Produce traceplot for the specified parameter — traceplot","text":"Produce traceplot specified parameter","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce traceplot for the specified parameter — traceplot","text":"","code":"traceplot(results, par, ind, chains = -1, ylim = NA, T = 1000)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce traceplot for the specified parameter — traceplot","text":"results output gibbs_wrapper. ind index parameter. \"B\" two-vector. \"sigma1\", \"sigma0\" \"pi\" single number. \"sigma\" ind ignored. chains indices chains included plot. Default -1, uses chains. ylim range y-axis final plot T number warmup period. pars parameter ploted. Must one \"B\", \"sigma\", \"sigma1\", \"sigma0\" \"pi\".","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce traceplot for the specified parameter — traceplot","text":"traceplot scalar parameter warmup-period","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform EM Algorithm on Pleiotropy — zero.centered.em","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"Fit two-component zero-mean Gaussian mixture sequence observed values","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"","code":"zero.centered.em(   values,   std.errors,   initial_slab_prob = 0.05,   initial_sigma1_squared = 0.1,   initial_sigma2_squared = 1e-04,   iters = 100,   optimizer = \"Brent\",   show_outputs = FALSE )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"values vector observations. initial_slab_prob initial value proportion slab (Gaussian component higher variance). Default .05. initial_sigma1_squared initial value variance slab component. Default .1. initial_sigma2_squared initial value variance spike component. Default .0001 iters number iterations EM algorithm. Default 100 optimizer method used Maximization Step. Must one \"Brent\", \"Nelder-Mead\" \"L-BFGS-B\". Default \"Brent\". show_outputs Whether included plot fitted density smoothed data density. Default FALSE. std.error standard error noise observations.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"list elements S1 standard deviation slab component S2 standard deviation spike component Pi proportion slab component","code":""}]
