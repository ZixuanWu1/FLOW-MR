[{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"FLOW-MR-tutorial","text":"FLOW-MR R package performing Mendelian Randomization mediation setting. tutorial demonstrates use package step step.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"FLOW-MR-tutorial","text":"","code":"# Install devtools if not installed install.packages(\"devtools\") #>  #> The downloaded binary packages are in #>  /var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T//RtmpDkucRo/downloaded_packages  # Install FLOW-MR devtools::install_github(\"ZixuanWu1/FLOW-MR\") #> rlang        (1.1.4    -> 1.1.5   ) [CRAN] #> cli          (3.6.3    -> 3.6.4   ) [CRAN] #> pillar       (1.9.0    -> 1.10.1  ) [CRAN] #> R6           (2.5.1    -> 2.6.1   ) [CRAN] #> Rcpp         (1.0.13   -> 1.0.14  ) [CRAN] #> withr        (3.0.1    -> 3.0.2   ) [CRAN] #> gtable       (0.3.5    -> 0.3.6   ) [CRAN] #> RcppArmad... (14.0.2-1 -> 14.2.3-1) [CRAN] #>  #> The downloaded binary packages are in #>  /var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T//RtmpDkucRo/downloaded_packages #> ── R CMD build ───────────────────────────────────────────────────────────────── #> * checking for file ‘/private/var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T/RtmpDkucRo/remotes7c715da2a286/ZixuanWu1-FLOW-MR-61a3970/DESCRIPTION’ ... OK #> * preparing ‘FLOWMR’: #> * checking DESCRIPTION meta-information ... OK #> * cleaning src #> Warning: bad markup (extra space?) at BayesMediation.Rd:48:21 #> Warning: bad markup (extra space?) at BayesMediation.Rd:49:22 #> Warning: bad markup (extra space?) at BayesMediation.Rd:50:26 #> Warning: bad markup (extra space?) at BayesMediation.Rd:52:27 #> Warning: bad markup (extra space?) at BayesMediation.Rd:54:29 #> Warning: bad markup (extra space?) at BayesMediation.Rd:56:30 #> Warning: bad markup (extra space?) at BayesMediation.Rd:58:17 #> Warning: bad markup (extra space?) at BayesMediation.Rd:59:18 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:64:9 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:65:9 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:66:14 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:67:14 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:68:10 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:69:13 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:24:12 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:25:16 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:26:10 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:27:13 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:28:12 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:29:14 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:30:11 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:31:13 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:42:10 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:43:10 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:44:10 #> * installing the package to process help pages #> * saving partial Rd database #> * cleaning src #> * checking for LF line-endings in source and make files and shell scripts #> * checking for empty or unneeded directories #> * building ‘FLOWMR_1.0.tar.gz’"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"load-the-package","dir":"Articles","previous_headings":"","what":"Load the Package","title":"FLOW-MR-tutorial","text":"","code":"library(FLOWMR)"},{"path":[]},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-1-prepare-input-data","dir":"Articles","previous_headings":"Example Usage","what":"Step 1: Prepare Input Data","title":"FLOW-MR-tutorial","text":", use GRAPPLE preprocess input data. can download GRAPPLE package using following command: Next, use GRAPPLE preprocess data following three-sample Mendelian Randomization (MR) design. sel.file used select genome-wide significant SNPs, exp.file contains exposures interest, .file contains outcomes interest. details, visit GRAPPLE GitHub. example use adult BMI GIANT childhoood BMI EGG selections files. use childhood body BMI MOBA, adult BMI UK biobank exposures, Breast Cancer paper outcome.","code":"devtools::install_github(\"jingshuw/grapple\") library(GRAPPLE)  # Selection file of snps sel.file <- c(\"~/Downloads/research/BMI-giant17eu.csv\", \"~/Downloads/research/bmi_child_egg.csv\" )  # Exposure file exp.file <- c( \"~/Downloads/research/childhood_bmi_nat_comm_2019_8years\",\"~/Downloads/research/BMI_adult.csv\" )  # Outcome file out.file <- \"~/Downloads/research/Breast-Micha17erp.csv\"  # Use plink to select independent significant SNPs plink_refdat <- \"~/Downloads/research/data_maf0.01_rs_ref/data_maf0.01_rs_ref\"  ## Use max.p.thres to decide the significance level of SNPs ## Use cal.cor = T to compute the noise correlation data.list <- GRAPPLE::getInput(sel.file, exp.file, out.file, plink_refdat, max.p.thres =1e-3,                                plink_exe = \"~/Downloads/research/plink_mac_20210606/plink\", cal.cor = T) #> [1] \"Marker candidates will not be obtained as number of risk factors k > 1\" #> [1] \"loading data for selection: ~/Downloads/research/BMI-giant17eu.csv ...\" #> [1] \"loading data for selection: ~/Downloads/research/bmi_child_egg.csv ...\" #> [1] \"loading data from exposure: ~/Downloads/research/childhood_bmi_nat_comm_2019_8years ...\" #> [1] \"loading data from exposure: ~/Downloads/research/BMI_adult.csv ...\" #> [1] \"loading data from outcome: ~/Downloads/research/Breast-Micha17erp.csv ...\" #> [1] \"Start clumping using PLINK ...\" #> [1] \"487 independent genetic instruments extracted. Done!\""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-2-run-flow-mr","dir":"Articles","previous_headings":"Example Usage","what":"Step 2: Run FLOW-MR","title":"FLOW-MR-tutorial","text":"run FLOW-MR, need prepare two input files, Gamma_hat Sd_hat. Also ensuring time order reversed. function BayesMediation execute Gibbs sampler. , can optionally provide cor_mat, K K matrix represents shared noise correlation GWAS summary statistics across traits. particularly useful GWAS summary statistics include overlapping samples. GRAPPLE estimates noise correlation first selecting non-significant SNPs (e.g., p-value > 0.5) computing correlation estimated effect sizes. default value diagonal matrix.","code":"dat <-data.list$data;  # Run the mediation method Gamma_hat =rbind(dat$gamma_out1,                   dat$gamma_exp2,                  dat$gamma_exp1)  Sd_hat = rbind(dat$se_out1,                 dat$se_exp2,                dat$se_exp1)  cor_mat = data.list$cor.mat[3:1, 3:1]  result = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat, inv = TRUE) #> [1] \"2025-03-14 11:55:25 CDT\" #> [1] \"2025-03-14 11:57:10 CDT\""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-3-look-at-summary-of-direct-effects","dir":"Articles","previous_headings":"Example Usage","what":"Step 3: Look at summary of direct effects","title":"FLOW-MR-tutorial","text":"step, print summary direct effects, row corresponds parameter. summary, provide estimated posterior mean, variance, standard deviation, 2.5% quantile, median, 97.5% quantile, effective sample size (ESS), Gelman-Rubin Rhat statistic parameter. ESS quantifies number independent samples, Rhat (Gelman-Rubin statistic) assesses convergence. See ESS Rhat detailed explanations ESS Rhat. meaning parameter, B[l, k] represents direct effect kk-th latest trait ll-th latest trait. example: B[1, 2] represents direct effect adult BMI breast cancer; B[1, 3] represents direct direct effect childhood BMI breast cancer; B[2, 3] represents direct direct effect childhood BMI adult BMI. See figure visualization.  meaning parameters, assume following priors manuscript: αkj∼(1−pk)N(0,σk02)+pkN(0,σk12) \\alpha_{kj} \\sim (1 - p_k)N(0, \\sigma_{k0}^2) + p_k N(0, \\sigma_{k1}^2) βkl∼N(0,σ2),l>k \\beta_{kl} \\sim N(0, \\sigma^2), \\quad l > k also include posterior summary parameters. summary, sigma1[k] represents standard deviation slab component trait kk, sigma0[k] represents standard deviation spike component trait kk, p[k] represents proportion slab component, sigma represents standard deviation BB. effects considered significant credible interval include 0. example, B[2, 3] B[1, 3] found significant, B[1,2] .","code":"print(result$summary) #>                   mean          var           sd         2.5%          50% #> B[1,2]     0.141866051 1.690846e-02 0.1300325229 -0.104926563  0.140193822 #> B[1,3]    -0.388057840 2.919489e-02 0.1708651177 -0.734887427 -0.384418091 #> B[2,3]     0.713930148 7.093020e-03 0.0842200699  0.570185527  0.706959237 #> sigma      0.438861906 1.336051e-02 0.1155876721  0.276587484  0.417741913 #> sigma1[1]  0.025779130 1.868805e-05 0.0043229683  0.019017152  0.025219493 #> sigma1[2]  0.025750103 6.300285e-05 0.0079374332  0.015839325  0.024068162 #> sigma1[3]  0.047771671 9.741439e-05 0.0098698729  0.032528606  0.046388461 #> sigma0[1]  0.004271716 7.381307e-07 0.0008591453  0.002761299  0.004214239 #> sigma0[2]  0.008388768 6.957819e-07 0.0008341354  0.006730439  0.008401480 #> sigma0[3]  0.011020590 1.559711e-06 0.0012488841  0.008687725  0.011006826 #> p[1]       0.099314293 1.245940e-03 0.0352978753  0.041376946  0.095277501 #> p[2]       0.023073770 3.257777e-04 0.0180493142  0.002542834  0.018454671 #> p[3]       0.041990350 2.540267e-04 0.0159382146  0.016782304  0.040033957 #>                  97.5%        ESS     Rhat #> B[1,2]     0.407567356  439.25692 1.002105 #> B[1,3]    -0.066591058  369.67624 1.007111 #> B[2,3]     0.897578677   68.76023 1.001522 #> sigma      0.716403789 3004.52552 1.003097 #> sigma1[1]  0.035743097 1457.78732 1.000962 #> sigma1[2]  0.045771036 3258.89012 1.000128 #> sigma1[3]  0.071003778 1137.78288 1.000100 #> sigma0[1]  0.006042001  191.53655 1.002549 #> sigma0[2]  0.009977830  373.67315 1.010593 #> sigma0[3]  0.013549715  352.16442 1.013229 #> p[1]       0.177034040  700.56206 1.003329 #> p[2]       0.070444940  744.26145 1.002014 #> p[3]       0.078818644 1713.76121 1.000228 knitr::include_graphics(\"/Users/zixuanwu/Documents/GitHub/FLOW-MR/docs/EffectVisual.png\")"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-4-optional-working-with-raw-outputs","dir":"Articles","previous_headings":"Example Usage","what":"Step 4 (Optional) Working with Raw outputs","title":"FLOW-MR-tutorial","text":"cases, summary table provides sufficient information. However, certain situations, may useful directly access posterior samples, need obtain quantiles. cases, can follow procedure outlined . Gibbs sampler, ran four chains parallel. access information -th chain, can use command result$raw[[]]. example result$raw[[1]]$B three dimensional array dimension K K N, K number traits N number iterations. Similarly, result$raw[[1]]$sigma1, result$raw[[1]]$sigma0, result$raw[[1]]$p two dimensional arrays dimension K N K number traits N number iterations. simplify procedure, one can use function get_posterior_samples FLOWMR extract posterior samples four chains particular parameter user-defined warm-period. parameter must one “B”, “sigma1”, “sigma0”, “sigma”, “p”. example, extract posterior samples B[1,3] 3000 warm-periods can check quantiles: can also draw histogram visualization:  sigma1, sgima0 p, index argument 1 dimensional. example  sigma, index argument NULL:","code":"post_B = get_posterior_samples(result$raw, par = \"B\", K = 3, ind = c(1,3), warmup = 3000) quantile(post_B, c(0.025, .5, 0.975)) #>        2.5%         50%       97.5%  #> -0.73488743 -0.38441809 -0.06659106 hist(post_B, breaks = 30) post_p = get_posterior_samples(result$raw, par = \"p\", K = 3, ind = 1, warmup = 3000) hist(post_p) post_sigma = get_posterior_samples(result$raw, par = \"sigma\", K = 3, ind = NULL, warmup = 3000) hist(post_sigma)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-5-optional-mcmc-diagnoistics-","dir":"Articles","previous_headings":"Example Usage","what":"Step 5 (Optional) MCMC diagnoistics.","title":"FLOW-MR-tutorial","text":"non-convergence issues arise (e.g., Rhat value greater 1.1), can generate trace plot posterior samples using function traceplot:   traceplot useful tool diagnosing MCMC convergence (See rstan example link. traceplot, line corresponds posterior samples one MCMC chain. Non-convergence indicated posterior samples four chains appear similar. convergence issues arise, consider increasing number iterations adjusting prior parameters","code":"FLOWMR::traceplot(result$raw, par = \"B\", ind = c(1,2)) # for B FLOWMR::traceplot(result$raw, par = \"sigma1\", ind = c(1)) # for sigma1, sigma0, p"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-5-estimating-path-wise-indirect-effects","dir":"Articles","previous_headings":"Example Usage","what":"Step 5 Estimating path-wise / indirect effects","title":"FLOW-MR-tutorial","text":"estimate path-wise effects, use following command. example, function indirect_effect evaluates indirect effect childhood BMI breast cancer adult BMI: path parameter specifies path interested . case 3 -> 2 -> 1. Alternatively, instead focusing specific path, can estimate sum effects non-direct paths. function indirect_effect summarizes posterior samples non-direct path-wise effects. outputs array df dimension K K 4, first two dimensions correspond dimensions B, third dimension contains mean, 2.5/% quantile, median, 97.5% quantile respectively. can also examine posterior inference total effects, represent sum direct indirect effects. Finally, demonstrate extract posterior samples total, indirect, path-wise effects, similar direct effects. total effect, use function get_total_samples.  path-wise effect, use function get_indirect_samples.  joint effect non-direct paths, still use function get_indirect_samples. case need set path “” specify index interests.  Finally can also get posterior samples proportions indirect effects relative total effects","code":"path_effect = indirect_effect(result$raw, K = 3, path = c(3,2,1),  warmup = 3000) print(path_effect) #>        Mean      2.5%        50%     97.5% #> 1 0.1049813 -0.071848 0.09737741 0.3369249 ind_effect = indirect_effect(result$raw, K = 3, path = \"all\",  warmup = 3000) print(ind_effect) #> , , Mean #>  #>      [,1] [,2]      [,3] #> [1,]    0    0 0.1049813 #> [2,]    0    0 0.0000000 #> [3,]    0    0 0.0000000 #>  #> , , Quantile_0.025 #>  #>      [,1] [,2]      [,3] #> [1,]    0    0 -0.071848 #> [2,]    0    0  0.000000 #> [3,]    0    0  0.000000 #>  #> , , Quantile_0.5 #>  #>      [,1] [,2]       [,3] #> [1,]    0    0 0.09737741 #> [2,]    0    0 0.00000000 #> [3,]    0    0 0.00000000 #>  #> , , Quantile_0.975 #>  #>      [,1] [,2]      [,3] #> [1,]    0    0 0.3369249 #> [2,]    0    0 0.0000000 #> [3,]    0    0 0.0000000 tot_effect = total_effect(result$raw, K = 3, warmup = 3000) print(tot_effect) #> , , Mean #>  #>      [,1]      [,2]       [,3] #> [1,]    0 0.1418661 -0.2830765 #> [2,]    0 0.0000000  0.7139301 #> [3,]    0 0.0000000  0.0000000 #>  #> , , Quantile_0.025 #>  #>      [,1]       [,2]       [,3] #> [1,]    0 -0.1049266 -0.4600292 #> [2,]    0  0.0000000  0.5701855 #> [3,]    0  0.0000000  0.0000000 #>  #> , , Quantile_0.5 #>  #>      [,1]      [,2]       [,3] #> [1,]    0 0.1401938 -0.2812061 #> [2,]    0 0.0000000  0.7069592 #> [3,]    0 0.0000000  0.0000000 #>  #> , , Quantile_0.975 #>  #>      [,1]      [,2]       [,3] #> [1,]    0 0.4075674 -0.1149826 #> [2,]    0 0.0000000  0.8975787 #> [3,]    0 0.0000000  0.0000000 tot_samples = get_total_samples(result$raw, 3, ind = c(1,3)) hist(tot_samples) path_samples = get_indirect_samples(result$raw, 3, path = c(3,2,1)) hist(path_samples) ind_samples = get_indirect_samples(result$raw, 3, path = \"all\", ind = c(1,3)) hist(ind_samples) hist(pmin(abs(ind_samples / tot_samples), 1), breaks = 60)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"FLOW-MR-tutorial","text":"tutorial introduced key functionalities FLOW-MR. details, refer package documentation.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zixuan Wu. Author, maintainer. Ethan Lewis. Author. Qingyuan Zhao. Author. Jingshu Wang. Author.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wu Z, Lewis E, Zhao Q, Wang J (2024). “Causal mediation analysis time-varying heritable risk factors Mendelian Randomization.” bioRxiv, 2024–02.","code":"@Article{,   title = {Causal mediation analysis for time-varying heritable risk factors with Mendelian Randomization},   author = {Zixuan Wu and Ethan Lewis and Qingyuan Zhao and Jingshu Wang},   journal = {bioRxiv},   year = {2024},   pages = {2024--02},   publisher = {Cold Spring Harbor Laboratory}, }"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"flow-mr","dir":"","previous_headings":"","what":"An R Package for Mendelian Randomization in the mediation setting","title":"An R Package for Mendelian Randomization in the mediation setting","text":"R package FLOW-MR, Bayesian framework Mendelian Randomization mediation setting. details FLOW-MR framework, please refer manuscript. give brief description method. Check tutorial complete workflow.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"An R Package for Mendelian Randomization in the mediation setting","text":"run package, might need first install RCpp CRAN package can installed R Github repository:","code":"install.packages(\"RCpp\") library(devtools) install_github(\"ZixuanWu1/FLOW-MR\")"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic Usage","title":"An R Package for Mendelian Randomization in the mediation setting","text":"Recall Mediation setting, Γ=B̃⋅Γ+α\\Gamma = \\tilde{B} \\cdot \\Gamma + \\alpha  Γ\\Gamma matrix true SNP effects, B̃\\tilde{B} upper-triangular matrix zero diagonalsand α\\alpha horizontal pleiotropy. B̃\\tilde{B} represents matrix direct effects. One might equivalently write Γ=(+B)α\\Gamma = (+ {B}) \\alpha order run MrMediation, need least two inputs, Gamma_hat Sd_hat. Gamma_hat matrix observation Γ\\Gamma. Typically K×PK \\times P matrix KK number phenotypes PP number measured genetic variants. Sd_hat matrix matrix standard deviation noise dimension Gamma_hat. estimate matrix BB, one can use following command inv = TRUE implies estimating B̃\\tilde{B}, opposed estimating B{B} inv = FALSE. One can also support correlation among measurement errors setting cor correlation matrix addition, order compute indirect effect exposures outcome, one can simply use following command Sometimes might see warning algorithm might convergenced. problem solved using iterations changing initialization method. One can also look traceplot parameters MCMC diagnosis. instance, following function gives traceplot parameter insterest chains. (using B[1,2]B[1,2] example.)","code":"result = BayesMediation(Gamma_hat, Sd_hat, inv = TRUE) result_cor = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat, inv = TRUE) result = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat, indirect = T) traceplot(result$raw, par = \"B\", ind = c(1,2))"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":null,"dir":"Reference","previous_headings":"","what":"BayesMediation — BayesMediation","title":"BayesMediation — BayesMediation","text":"Bayes approach FLOW MR model.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BayesMediation — BayesMediation","text":"","code":"BayesMediation(   Gamma_hat,   Sd_hat,   init = \"Random\",   iter = 6000,   warmup = 3000,   second = F,   inv = FALSE,   cor = NULL,   Raw = T,   total = F,   indirect = F )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BayesMediation — BayesMediation","text":"Gamma_hat estimated exposure outcome effects gamma_hat Sd_hat standarded errors gamma_hat init Starting value gibbs sampler. Either \"Random\" \"EM\" iter number iterations gibbs sampler warmup length warm-periods second Whether run second stage. Default False. inv inv = False, estiming B Gamma = (+ B) alpha; inv = True, estimating B Gamma = B Gamma + alpha. cor correlation matrix noise. Raw Whether include unprocessed raw outputs. Default F total Whether include total effects. Default F indirect Whether include indirect effects. Default F.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"BayesMediation — BayesMediation","text":"list elements summary_first summary table first stage summary_second summary table second stage (included second  = T) total_effect_first total effect exposure outcome, computed first stage (included total = T) total_effect_second total effect exposure outcome, computed second stage (included total = T second = T) indirect_effect_first indirect effect exposure outcome, computed first stage (included indirect = T) indirect_effect_second indirect effect exposure outcome, computed second stage (included indirect = T  second = T) raw_first unprocessed output first stage (included raw= T) raw_second unprocessed output second stage (included raw = T second = T)","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"Bayesian framework Mendelian Randomization mediation setting.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"DESCRIPTION file: package yet installed build time.   Index:  package yet installed build time.  ~~ overview use package, including important functions ~~","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"Zixuan Wu [aut, cre],   Ethan Lewis [aut],   Qingyuan Zhao [aut],   Jingshu Wang [aut] Maintainer: Zixuan Wu <zixuanwu@uchicago.edu>","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"~~ Literature references background information ~~","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"","code":"# simple examples of the most important functions ~~"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_indirect_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior samples of indirect effects — get_indirect_samples","title":"Posterior samples of indirect effects — get_indirect_samples","text":"Estimate indirrect effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_indirect_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior samples of indirect effects — get_indirect_samples","text":"","code":"get_indirect_samples(results, K, warmup = 3000, path = NULL, ind = NULL)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_indirect_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior samples of indirect effects — get_indirect_samples","text":"results results gibbs_wrapper K number phenotypes warmup length warmup period. Default 3000 path vector representing pathway interests ind index indirect effect interest path NULL","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_indirect_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior samples of indirect effects — get_indirect_samples","text":"vector posterior samples","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_posterior_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior samples — get_posterior_samples","title":"Posterior samples — get_posterior_samples","text":"Estimate total effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_posterior_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior samples — get_posterior_samples","text":"","code":"get_posterior_samples(raw, par, ind = NULL, warmup = 3000)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_posterior_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior samples — get_posterior_samples","text":"raw raw results par parameter interets ind index parameter warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_posterior_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior samples — get_posterior_samples","text":"vector posterior samples chains","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_total_samples.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior samples of total effects — get_total_samples","title":"Posterior samples of total effects — get_total_samples","text":"Estimate total effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_total_samples.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior samples of total effects — get_total_samples","text":"","code":"get_total_samples(results, K, ind, warmup = 3000)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_total_samples.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior samples of total effects — get_total_samples","text":"results results gibbs_wrapper K number phenotypes ind index interet warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/get_total_samples.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior samples of total effects — get_total_samples","text":"K K 4 array summary total effect.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"Model Y = (+B)+ noise","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"","code":"gibbs_sampler(   Y,   Sd_hat,   N,   B,   sigma,   sigma1,   sigma0,   p,   A,   Z,   alpha_B,   beta_B,   alpha_0,   alpha_1,   beta_0,   beta_1,   a,   b )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"Y KxP arma::matrix GWAS marginal associations Sd_hat KxP arma::matrix GWAS std errors N number samples obtain B initial value B arma::matrix sigma Initial value prior std deviation values B sigma1 K-arma::vector Initial values prior slab SDs trait's pleiotropy sigma0 K-arma::vector Initial values prior splike SDs trait's pleiotropy p K-arma::vector initial values p, slab probability mixture KxP arma::matrix initial values (ignored) Z KxP arma::matrix initial values Z (ignored), latent varaible indicating [,j] comes slab alpha_B Shape parameter InvGamma prior sigma (B) beta_B Scale parameter InvGamma prior sigma (B) alpha_0 K-arma::vector Shape parameter InvGamma prior sigma0 (Spike) alpha_1 K-arma::vector Shape parameter InvGamma prior sigma0 (Slab) beta_0 K-arma::vector Scale parameter InvGamma prior sigma0 (Spike) beta_1 K-arma::vector Scale parameter InvGamma prior sigma0 (Slab) K-arma::vector First parameter beta prior p b K-arma::vector Second parameter beta prior p","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"Model Y = (+B)+ noise","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"","code":"gibbs_sampler_with_corr(   Y,   Sd_hat,   trait_corr,   N,   B,   sigma,   sigma1,   sigma0,   p,   A,   Z,   alpha_B,   beta_B,   alpha_0,   alpha_1,   beta_0,   beta_1,   a,   b,   Lambda3,   Lambda_inv3 )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"Y KxP arma::matrix GWAS marginal associations Sd_hat KxP arma::matrix GWAS std errors trait_corr KxK arma::matrix correlation noises. N number samples obtain B initial value B arma::matrix sigma Initial value prior std deviation values B sigma1 K-arma::vector Initial values prior slab SDs trait's pleiotropy sigma0 K-arma::vector Initial values prior splike SDs trait's pleiotropy p K-arma::vector initial values p, slab probability mixture KxP arma::matrix initial values (ignored) Z KxP arma::matrix initial values Z (ignored), latent varaible indicating [,j] comes slab alpha_B Shape parameter InvGamma prior sigma (B) beta_B Scale parameter InvGamma prior sigma (B) alpha_0 K-arma::vector Shape parameter InvGamma prior sigma0 (Spike) alpha_1 K-arma::vector Shape parameter InvGamma prior sigma0 (Slab) beta_0 K-arma::vector Scale parameter InvGamma prior sigma0 (Spike) beta_1 K-arma::vector Scale parameter InvGamma prior sigma0 (Slab) K-arma::vector First parameter beta prior p b K-arma::vector Second parameter beta prior p Lambda3 Precomputed covariance matrix Lambda_inv3 Precomputed inverse covariance matrix","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Gibbs sampler — gibbs_wrapper","title":"Gibbs sampler — gibbs_wrapper","text":"Given observed effect standard error, run gibbs sampler draw samples posterior density","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gibbs sampler — gibbs_wrapper","text":"","code":"gibbs_wrapper(   N,   warmup,   chains = 4,   Gamma_hat,   Sd_hat,   sigma,   sigma_1,   sigma_0,   p,   parallel = TRUE,   init = \"Random\",   ratio = 10,   cor_mat = NULL,   Lambda = NULL,   Lambda_inv = NULL )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gibbs sampler — gibbs_wrapper","text":"N Number total iterations warmup Number warm-iterations. chains Number Chains. Gamma_hat observed effects Sd_hat standard deviation Gamma_hat sigma prior mean sigma sigma_1 prior mean sigma_1 sigma_0 prior mean sigma_0 p prior mean p parallel Indicating whether parallelly run chains. Default True. init Method Initialization. Must one \"EM\" \"Random\". Default \"Random\" ratio ratio initial sigma1 sigma0 initialization method \"Random\". Default 10. cor_mat correlation matrix noise. Default null (correlation) Lambda block diagonal matrix block covariance matrix noise SNP. Default NULL (provided) Lambda_inv block diagonal matrix block inverse covariance matrix noise SNP. Default NULL (provided).","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gibbs sampler — gibbs_wrapper","text":"list elements outputs chain. outputs list attributes B  p  sigma1  sigma0  pi  sigma","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Indirrect effedt — indirect_effect","title":"Indirrect effedt — indirect_effect","text":"Estimate indirrect effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Indirrect effedt — indirect_effect","text":"","code":"indirect_effect(   results,   K,   warmup = 3000,   path = NULL,   quantiles = c(0.025, 0.5, 0.975) )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Indirrect effedt — indirect_effect","text":"results results gibbs_wrapper K number phenotypes quantiles vector quantiles interests warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Indirrect effedt — indirect_effect","text":"K K 4 array summary direct effect.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/sigma_objective.html","id":null,"dir":"Reference","previous_headings":"","what":"The log likelihood function in the M-step — sigma_objective","title":"The log likelihood function in the M-step — sigma_objective","text":"log likelihood function M-step","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/sigma_objective.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The log likelihood function in the M-step — sigma_objective","text":"","code":"sigma_objective(sigma.sq, weights, values, std.errors)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"Produce summary table output gibbs_wrapper.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"","code":"summary_gibbs(result, pars, K, T = 1000, inv = FALSE)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"result output gibbs_wrapper gibbs_wrapper_cor pars vector parameters included summary table K number mediation layers T warmup period. Default 1000. inv inv TRUE, function shows summary statistics B Gamma = B Gamma + alpha, otherwise shows summary statistics B Gamma = (+ B) alpha. Default False","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"table row corresponds parameter. columns: mean average samples warm-variance variance samples warm-sd standard deviation samples warm-2.5% 2.5% quantile samples warm-50% 50  97.5% 97.5% quantile samples warm-ESS Effective sample sizes (combined chains) R_hat measure convergence. value 1.1 indicates sign convergence","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Total effect — total_effect","title":"Total effect — total_effect","text":"Estimate total effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Total effect — total_effect","text":"","code":"total_effect(results, K, warmup = 3000, quantiles = c(0.025, 0.5, 0.975))"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Total effect — total_effect","text":"results results gibbs_wrapper K number phenotypes quantiles Quantiles interests warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Total effect — total_effect","text":"K K 4 array summary total effect.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce traceplot for the specified parameter — traceplot","title":"Produce traceplot for the specified parameter — traceplot","text":"Produce traceplot specified parameter","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce traceplot for the specified parameter — traceplot","text":"","code":"traceplot(results, par, ind, chains = -1, ylim = NA, T = 1000)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce traceplot for the specified parameter — traceplot","text":"results output gibbs_wrapper. ind index parameter. \"B\" two-vector. \"sigma1\", \"sigma0\" \"pi\" single number. \"sigma\" ind ignored. chains indices chains included plot. Default -1, uses chains. ylim range y-axis final plot T number warmup period. pars parameter ploted. Must one \"B\", \"sigma\", \"sigma1\", \"sigma0\" \"pi\".","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce traceplot for the specified parameter — traceplot","text":"traceplot scalar parameter warmup-period","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform EM Algorithm on Pleiotropy — zero.centered.em","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"Fit two-component zero-mean Gaussian mixture sequence observed values","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"","code":"zero.centered.em(   values,   std.errors,   initial_slab_prob = 0.05,   initial_sigma1_squared = 0.1,   initial_sigma2_squared = 1e-04,   iters = 100,   optimizer = \"Brent\",   show_outputs = FALSE )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"values vector observations. initial_slab_prob initial value proportion slab (Gaussian component higher variance). Default .05. initial_sigma1_squared initial value variance slab component. Default .1. initial_sigma2_squared initial value variance spike component. Default .0001 iters number iterations EM algorithm. Default 100 optimizer method used Maximization Step. Must one \"Brent\", \"Nelder-Mead\" \"L-BFGS-B\". Default \"Brent\". show_outputs Whether included plot fitted density smoothed data density. Default FALSE. std.error standard error noise observations.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"list elements S1 standard deviation slab component S2 standard deviation spike component Pi proportion slab component","code":""}]
