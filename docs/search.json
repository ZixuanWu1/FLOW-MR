[{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"FLOW-MR-tutorial","text":"FLOW-MR R package performing Mendelian Randomization mediation setting. tutorial demonstrates use package step step.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"FLOW-MR-tutorial","text":"","code":"# Install devtools if not installed install.packages(\"devtools\") #> Installing package into '/private/var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T/RtmpMnRMVQ/temp_libpath4da03610fba6' #> (as 'lib' is unspecified) #>  #> The downloaded binary packages are in #>  /var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T//Rtmp4E55Rr/downloaded_packages  # Install FLOW-MR devtools::install_github(\"ZixuanWu1/FLOW-MR\") #> Downloading GitHub repo ZixuanWu1/FLOW-MR@HEAD #> rlang        (1.1.4    -> 1.1.5   ) [CRAN] #> cli          (3.6.3    -> 3.6.4   ) [CRAN] #> pillar       (1.9.0    -> 1.10.1  ) [CRAN] #> R6           (2.5.1    -> 2.6.1   ) [CRAN] #> Rcpp         (1.0.13   -> 1.0.14  ) [CRAN] #> withr        (3.0.1    -> 3.0.2   ) [CRAN] #> gtable       (0.3.5    -> 0.3.6   ) [CRAN] #> RcppArmad... (14.0.2-1 -> 14.2.3-1) [CRAN] #> Installing 8 packages: rlang, cli, pillar, R6, Rcpp, withr, gtable, RcppArmadillo #> Installing packages into '/private/var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T/RtmpMnRMVQ/temp_libpath4da03610fba6' #> (as 'lib' is unspecified) #>  #> The downloaded binary packages are in #>  /var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T//Rtmp4E55Rr/downloaded_packages #> ── R CMD build ───────────────────────────────────────────────────────────────── #> * checking for file ‘/private/var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T/Rtmp4E55Rr/remotes52aa58892cdb/ZixuanWu1-FLOW-MR-2d061a7/DESCRIPTION’ ... OK #> * preparing ‘FLOWMR’: #> * checking DESCRIPTION meta-information ... OK #> * cleaning src #> Warning: bad markup (extra space?) at BayesMediation.Rd:48:21 #> Warning: bad markup (extra space?) at BayesMediation.Rd:49:22 #> Warning: bad markup (extra space?) at BayesMediation.Rd:50:26 #> Warning: bad markup (extra space?) at BayesMediation.Rd:52:27 #> Warning: bad markup (extra space?) at BayesMediation.Rd:54:29 #> Warning: bad markup (extra space?) at BayesMediation.Rd:56:30 #> Warning: bad markup (extra space?) at BayesMediation.Rd:58:17 #> Warning: bad markup (extra space?) at BayesMediation.Rd:59:18 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:64:9 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:65:9 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:66:14 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:67:14 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:68:10 #> Warning: bad markup (extra space?) at gibbs_wrapper.Rd:69:13 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:24:12 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:25:16 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:26:10 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:27:13 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:28:12 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:29:14 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:30:11 #> Warning: bad markup (extra space?) at summary_gibbs.Rd:31:13 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:42:10 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:43:10 #> Warning: bad markup (extra space?) at zero.centered.em.Rd:44:10 #> * installing the package to process help pages #> * saving partial Rd database #> * cleaning src #> * checking for LF line-endings in source and make files and shell scripts #> * checking for empty or unneeded directories #> * building ‘FLOWMR_1.0.tar.gz’ #> Installing package into '/private/var/folders/1p/kyg0zmtx4gdg27q_5x4d78fc0000gn/T/RtmpMnRMVQ/temp_libpath4da03610fba6' #> (as 'lib' is unspecified)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"load-the-package","dir":"Articles","previous_headings":"","what":"Load the Package","title":"FLOW-MR-tutorial","text":"","code":"library(FLOWMR) library(magic) #> Loading required package: abind"},{"path":[]},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-1-prepare-input-data","dir":"Articles","previous_headings":"Example Usage","what":"Step 1: Prepare Input Data","title":"FLOW-MR-tutorial","text":"use GRAPPLE read preprocess input data. One can downlaod GRAPPLE package using following command. can use GPAPPLE pre-process Data. follow three-sample MR design . sel.file used select genome-wide significant SNPs. exp.file contains exposures interests. .file contains outcome interests. details, see https://github.com/jingshuw/GRAPPLE. example use adult BMI GIANT childhoood BMI egg selections files. use chilldhood body size bmi adult UK biobank exposures, Breast Cancer Micha outcome.","code":"devtools::install_github(\"jingshuw/grapple\") #> Skipping install of 'GRAPPLE' from a github remote, the SHA1 (317e8373) has not changed since last install. #>   Use `force = TRUE` to force installation library(GRAPPLE)  # Selection file of snps sel.file <- c(\"~/Downloads/research/BMI-giant17eu.csv\", \"~/Downloads/research/bmi_child_agg.csv\" )  # Exposure file exp.file <- c( \"~/Downloads/research/childhood_body_size.csv\",\"~/Downloads/research/BMI_adult.csv\" )  # Outcome file out.file <- \"~/Downloads/research/Breast-Micha17erp.csv\"  # Use plink to select independent significant SNPs plink_refdat <- \"~/Downloads/research/data_maf0.01_rs_ref/data_maf0.01_rs_ref\"  ## Use max.p.thres to decide the significance level of SNPs ## Use cal.cor = T to compute the noise correlation data.list <- GRAPPLE::getInput(sel.file, exp.file, out.file, plink_refdat, max.p.thres =0.01,                                plink_exe = \"~/Downloads/research/plink_mac_20210606/plink\", cal.cor = T) #> [1] \"Marker candidates will not be obtained as number of risk factors k > 1\" #> [1] \"loading data for selection: ~/Downloads/research/BMI-giant17eu.csv ...\" #> [1] \"loading data for selection: ~/Downloads/research/bmi_child_agg.csv ...\" #> [1] \"loading data from exposure: ~/Downloads/research/childhood_body_size.csv ...\" #> [1] \"loading data from exposure: ~/Downloads/research/BMI_adult.csv ...\" #> Warning in harmonise_cleanup_variables(res.tab): NAs introduced by coercion #> [1] \"loading data from outcome: ~/Downloads/research/Breast-Micha17erp.csv ...\" #> [1] \"Start clumping using PLINK ...\" #> Loading required package: data.table #>  #> Attaching package: 'data.table' #> The following object is masked from 'package:magic': #>  #>     shift #> [1] \"813 independent genetic instruments extracted. Done!\""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-2-run-flow-mr","dir":"Articles","previous_headings":"Example Usage","what":"Step 2: Run FLOW-MR","title":"FLOW-MR-tutorial","text":"order run FLOW-MR, need prepare two input files Gamma_hat Sd_hat, reversed time order","code":"dat <-data.list$data;  # Run the mediation method Gamma_hat =rbind(dat$gamma_out1,                   dat$gamma_exp2,                  dat$gamma_exp1)  Sd_hat = rbind(dat$se_out1,                 dat$se_exp2,                dat$se_exp1)  result = BayesMediation(Gamma_hat, Sd_hat, cor = data.list$cor.mat) #> [1] \"2025-03-11 16:00:24 CDT\" #> [1] \"2025-03-11 16:04:49 CDT\""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-3-look-at-summary-of-direct-effects","dir":"Articles","previous_headings":"Example Usage","what":"Step 3: Look at summary of direct effects","title":"FLOW-MR-tutorial","text":"print results direct effects. row corresponds parameter. instance B[1, 2] represents effect adult BMI breast cancer, B[1, 3] represents direct effect childhood BMI breast cancer, B[2, 3] represents direct effect childhood BMI Adult BMI. ESS represents effective sample size, Rhat Gelman-Rubin statistics case non-convergence (large Rhat), one can use following command see traceplot posterior samples","code":"print(result$summary) #>                   mean          var           sd         2.5%          50% #> B[1,2]    -0.115401772 5.448561e-03 0.0738143712 -0.258989540 -0.116772516 #> B[1,3]    -0.349770699 5.952166e-03 0.0771502819 -0.500633472 -0.349542650 #> B[2,3]     1.486012961 3.012862e-03 0.0548895398  1.379180578  1.485076322 #> sigma      0.628870999 2.492000e-02 0.1578606978  0.401412398  0.602327181 #> sigma1[1]  0.026220009 1.481295e-05 0.0038487602  0.020126852  0.025717490 #> sigma1[2]  0.017487449 1.948333e-05 0.0044139927  0.012229485  0.016493869 #> sigma1[3]  0.016801650 3.714487e-06 0.0019273004  0.013572255  0.016607753 #> sigma0[1]  0.004338455 4.794462e-07 0.0006924205  0.003051686  0.004335923 #> sigma0[2]  0.005943455 1.255415e-07 0.0003543183  0.005210316  0.005962192 #> sigma0[3]  0.003752879 3.762381e-08 0.0001939686  0.003359107  0.003755688 #> p[1]       0.082905498 6.439988e-04 0.0253771313  0.039889868  0.080771651 #> p[2]       0.039106441 6.894864e-04 0.0262580725  0.004218164  0.033979817 #> p[3]       0.097005043 5.063891e-04 0.0225030909  0.058734997  0.095202473 #>                  97.5%        ESS      Rhat #> B[1,2]     0.027441284  3061.5942 0.9999838 #> B[1,3]    -0.200982185  3461.0723 1.0000514 #> B[2,3]     1.598052519   513.6869 1.0004185 #> sigma      1.013003886 11825.9652 1.0002782 #> sigma1[1]  0.035130218  1068.4865 1.0006927 #> sigma1[2]  0.028499099   969.3300 1.0021815 #> sigma1[3]  0.020997320  1747.6425 1.0005458 #> sigma0[1]  0.005677666   157.8393 1.0052341 #> sigma0[2]  0.006592855   570.3329 1.0030456 #> sigma0[3]  0.004127756  1181.4439 1.0010404 #> p[1]       0.137895782   605.1173 1.0011770 #> p[2]       0.101026303   309.4166 1.0067154 #> p[3]       0.145622044  1012.3245 1.0002989 FLOWMR::traceplot(result$raw, par = \"B\", ind = c(1,2))"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"step-4","dir":"Articles","previous_headings":"Example Usage","what":"Step 4","title":"FLOW-MR-tutorial","text":"One can use following command get path-wise effect. example look path childhood BMI -> Adult BMI -> Breast Cancer","code":"path_effect = indirect_effect(result$raw, K = 3, path = c(3,2,1),  warmup = 3000) print(path_effect) #>         Mean       2.5%        50%      97.5% #> 1 -0.1713112 -0.3853506 -0.1726248 0.04051449"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/articles/FLOW-MR-tutorial.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"FLOW-MR-tutorial","text":"tutorial introduced key functionalities FLOW-MR. details, visit package documentation.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jingshu Wang. Author. Ethan Lewis. Author. Zixuan Wu. Author, maintainer.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Wang J, Lewis E, Wu Z (2025). FLOWMR: R Package Mendelian Randomization mediation setting. R package version 1.0.","code":"@Manual{,   title = {FLOWMR: An R Package for Mendelian Randomization in the mediation setting},   author = {Jingshu Wang and Ethan Lewis and Zixuan Wu},   year = {2025},   note = {R package version 1.0}, }"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"flow-mr","dir":"","previous_headings":"","what":"An R Package for Mendelian Randomization in the mediation setting","title":"An R Package for Mendelian Randomization in the mediation setting","text":"R package FLOW-MR, Bayesian framework Mendelian Randomization mediation setting.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"An R Package for Mendelian Randomization in the mediation setting","text":"run package, might need first install RCpp CRAN package can installed R Github repository:","code":"install.packages(\"RCpp\") library(devtools) install_github(\"ZixuanWu1/FLOW-MR\")"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/index.html","id":"basic-usage","dir":"","previous_headings":"","what":"Basic Usage","title":"An R Package for Mendelian Randomization in the mediation setting","text":"Recall Mediation setting, Γ=B⋅Γ+α\\Gamma = B \\cdot \\Gamma + \\alpha  Γ\\Gamma matrix true SNP effects, BB upper-triangular matrix zero diagonalsand α\\alpha horizontal pleiotropy. One might equivalently write Γ=(+B̃)α\\Gamma = (+ \\tilde{B}) \\alpha order run MrMediation, need least two inputs, Gamma_hat Sd_hat. Gamma_hat matrix observation Γ\\Gamma. Typically K×PK \\times P matrix KK number phenotypes PP number measured genetic variants. Sd_hat matrix matrix standard deviation noise dimension Gamma_hat. estimate matrix BB, one can use following command inv = TRUE implies estimating B, opposed estimating B̃\\tilde{B} inv = FALSE. One can also support correlation among measurement errors setting cor correlation matrix addition, order compute indirect effect exposures outcome, one can simply use following command Sometimes might see warning algorithm might convergenced. problem solved using iterations changing initialization method. One can also look traceplot parameters MCMC diagnosis. instance, following function gives traceplot parameter insterest chains. (using B[1,2]B[1,2] example.)","code":"result = BayesMediation(Gamma_hat, Sd_hat, inv = TRUE) result_cor = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat, inv = TRUE) result = BayesMediation(Gamma_hat, Sd_hat, cor = cor_mat, indirect = T) traceplot(result$raw, par = \"B\", ind = c(1,2))"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":null,"dir":"Reference","previous_headings":"","what":"BayesMediation — BayesMediation","title":"BayesMediation — BayesMediation","text":"Bayes approach MR Mediation model.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"BayesMediation — BayesMediation","text":"","code":"BayesMediation(   Gamma_hat,   Sd_hat,   init = \"Random\",   iter = 6000,   warmup = 3000,   second = F,   inv = FALSE,   cor = NULL,   Raw = T,   total = F,   indirect = F )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"BayesMediation — BayesMediation","text":"Gamma_hat estimated exposure outcome effects gamma_hat Sd_hat standarded errors gamma_hat init Starting value gibbs sampler. Either \"Random\" \"EM\" iter number iterations gibbs sampler warmup length warm-periods second Whether run second stage. Default False. inv inv = False, estiming B Gamma = (+ B) alpha; inv = True, estimating B Gamma = B Gamma + alpha. cor correlation matrix noise. Raw Whether include unprocessed raw outputs. Default F total Whether include total effects. Default F indirect Whether include indirect effects. Default F.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/BayesMediation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"BayesMediation — BayesMediation","text":"list elements summary_first summary table first stage summary_second summary table second stage (included second  = T) total_effect_first total effect exposure outcome, computed first stage (included total = T) total_effect_second total effect exposure outcome, computed second stage (included total = T second = T) indirect_effect_first indirect effect exposure outcome, computed first stage (included indirect = T) indirect_effect_second indirect effect exposure outcome, computed second stage (included indirect = T  second = T) raw_first unprocessed output first stage (included raw= T) raw_second unprocessed output second stage (included raw = T second = T)","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":null,"dir":"Reference","previous_headings":"","what":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"Bayesian framework Mendelian Randomization mediation setting.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"DESCRIPTION file: package yet installed build time.   Index:  package yet installed build time.  ~~ overview use package, including important functions ~~","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"Jingshu Wang [aut],   Ethan Lewis [aut],   Zixuan Wu [aut, cre] Maintainer: Zixuan Wu <zixuanwu@uchicago.edu>","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"~~ Literature references background information ~~","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/FLOWMR-package.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"An R Package for Mendelian Randomization in the mediation setting — FLOWMR-package","text":"","code":"# simple examples of the most important functions ~~"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"Model Y = (+B)+ noise","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"","code":"gibbs_sampler(   Y,   Sd_hat,   N,   B,   sigma,   sigma1,   sigma0,   p,   A,   Z,   alpha_B,   beta_B,   alpha_0,   alpha_1,   beta_0,   beta_1,   a,   b )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Gibbs sampling for mediation MR without correlation — gibbs_sampler","text":"Y KxP arma::matrix GWAS marginal associations Sd_hat KxP arma::matrix GWAS std errors N number samples obtain B initial value B arma::matrix sigma Initial value prior std deviation values B sigma1 K-arma::vector Initial values prior slab SDs trait's pleiotropy sigma0 K-arma::vector Initial values prior splike SDs trait's pleiotropy p K-arma::vector initial values p, slab probability mixture KxP arma::matrix initial values (ignored) Z KxP arma::matrix initial values Z (ignored), latent varaible indicating [,j] comes slab alpha_B Shape parameter InvGamma prior sigma (B) beta_B Scale parameter InvGamma prior sigma (B) alpha_0 K-arma::vector Shape parameter InvGamma prior sigma0 (Spike) alpha_1 K-arma::vector Shape parameter InvGamma prior sigma0 (Slab) beta_0 K-arma::vector Scale parameter InvGamma prior sigma0 (Spike) beta_1 K-arma::vector Scale parameter InvGamma prior sigma0 (Slab) K-arma::vector First parameter beta prior p b K-arma::vector Second parameter beta prior p","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"Model Y = (+B)+ noise","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"","code":"gibbs_sampler_with_corr(   Y,   Sd_hat,   trait_corr,   N,   B,   sigma,   sigma1,   sigma0,   p,   A,   Z,   alpha_B,   beta_B,   alpha_0,   alpha_1,   beta_0,   beta_1,   a,   b,   Lambda3,   Lambda_inv3 )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_sampler_with_corr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform Gibbs sampling for mediation MR with correlation — gibbs_sampler_with_corr","text":"Y KxP arma::matrix GWAS marginal associations Sd_hat KxP arma::matrix GWAS std errors trait_corr KxK arma::matrix correlation noises. N number samples obtain B initial value B arma::matrix sigma Initial value prior std deviation values B sigma1 K-arma::vector Initial values prior slab SDs trait's pleiotropy sigma0 K-arma::vector Initial values prior splike SDs trait's pleiotropy p K-arma::vector initial values p, slab probability mixture KxP arma::matrix initial values (ignored) Z KxP arma::matrix initial values Z (ignored), latent varaible indicating [,j] comes slab alpha_B Shape parameter InvGamma prior sigma (B) beta_B Scale parameter InvGamma prior sigma (B) alpha_0 K-arma::vector Shape parameter InvGamma prior sigma0 (Spike) alpha_1 K-arma::vector Shape parameter InvGamma prior sigma0 (Slab) beta_0 K-arma::vector Scale parameter InvGamma prior sigma0 (Spike) beta_1 K-arma::vector Scale parameter InvGamma prior sigma0 (Slab) K-arma::vector First parameter beta prior p b K-arma::vector Second parameter beta prior p Lambda3 Precomputed covariance matrix Lambda_inv3 Precomputed inverse covariance matrix","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":null,"dir":"Reference","previous_headings":"","what":"Gibbs sampler — gibbs_wrapper","title":"Gibbs sampler — gibbs_wrapper","text":"Given observed effect standard error, run gibbs sampler draw samples posterior density","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gibbs sampler — gibbs_wrapper","text":"","code":"gibbs_wrapper(   N,   warmup,   chains = 4,   Gamma_hat,   Sd_hat,   sigma,   sigma_1,   sigma_0,   p,   parallel = TRUE,   init = \"Random\",   ratio = 10,   cor_mat = NULL,   Lambda = NULL,   Lambda_inv = NULL )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gibbs sampler — gibbs_wrapper","text":"N Number total iterations warmup Number warm-iterations. chains Number Chains. Gamma_hat observed effects Sd_hat standard deviation Gamma_hat sigma prior mean sigma sigma_1 prior mean sigma_1 sigma_0 prior mean sigma_0 p prior mean p parallel Indicating whether parallelly run chains. Default True. init Method Initialization. Must one \"EM\" \"Random\". Default \"Random\" ratio ratio initial sigma1 sigma0 initialization method \"Random\". Default 10. cor_mat correlation matrix noise. Default null (correlation) Lambda block diagonal matrix block covariance matrix noise SNP. Default NULL (provided) Lambda_inv block diagonal matrix block inverse covariance matrix noise SNP. Default NULL (provided).","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/gibbs_wrapper.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gibbs sampler — gibbs_wrapper","text":"list elements outputs chain. outputs list attributes B  p  sigma1  sigma0  pi  sigma","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Indirrect effedt — indirect_effect","title":"Indirrect effedt — indirect_effect","text":"Estimate indirrect effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Indirrect effedt — indirect_effect","text":"","code":"indirect_effect(   results,   K,   warmup = 3000,   path = NULL,   quantiles = c(0.025, 0.5, 0.975) )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Indirrect effedt — indirect_effect","text":"results results gibbs_wrapper K number phenotypes quantiles vector quantiles interests warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/indirect_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Indirrect effedt — indirect_effect","text":"matrix indirect effect quantiles.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/sigma_objective.html","id":null,"dir":"Reference","previous_headings":"","what":"The log likelihood function in the M-step — sigma_objective","title":"The log likelihood function in the M-step — sigma_objective","text":"log likelihood function M-step","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/sigma_objective.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"The log likelihood function in the M-step — sigma_objective","text":"","code":"sigma_objective(sigma.sq, weights, values, std.errors)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"Produce summary table output gibbs_wrapper.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"","code":"summary_gibbs(result, pars, K, T = 1000, inv = FALSE)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"result output gibbs_wrapper gibbs_wrapper_cor pars vector parameters included summary table K number mediation layers T warmup period. Default 1000. inv inv TRUE, function shows summary statistics B Gamma = B Gamma + alpha, otherwise shows summary statistics B Gamma = (+ B) alpha. Default False","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/summary_gibbs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce a summary table of the output from gibbs_wrapper. — summary_gibbs","text":"table row corresponds parameter. columns: mean average samples warm-variance variance samples warm-sd standard deviation samples warm-2.5% 2.5% quantile samples warm-50% 50  97.5% 97.5% quantile samples warm-ESS Effective sample sizes (combined chains) R_hat measure convergence. value 1.1 indicates sign convergence","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":null,"dir":"Reference","previous_headings":"","what":"Total effect — total_effect","title":"Total effect — total_effect","text":"Estimate total effect exposure outcome","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Total effect — total_effect","text":"","code":"total_effect(results, K, warmup = 3000)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Total effect — total_effect","text":"results results gibbs_wrapper K number phenotypes warump length warmup period. Default 3000","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/total_effect.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Total effect — total_effect","text":"matrix total effect quantiles.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":null,"dir":"Reference","previous_headings":"","what":"Produce traceplot for the specified parameter — traceplot","title":"Produce traceplot for the specified parameter — traceplot","text":"Produce traceplot specified parameter","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Produce traceplot for the specified parameter — traceplot","text":"","code":"traceplot(results, par, ind, chains = -1, ylim = NA, T = 1000)"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Produce traceplot for the specified parameter — traceplot","text":"results output gibbs_wrapper. ind index parameter. \"B\" two-vector. \"sigma1\", \"sigma0\" \"pi\" single number. \"sigma\" ind ignored. chains indices chains included plot. Default -1, uses chains. ylim range y-axis final plot T number warmup period. pars parameter ploted. Must one \"B\", \"sigma\", \"sigma1\", \"sigma0\" \"pi\".","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/traceplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Produce traceplot for the specified parameter — traceplot","text":"traceplot scalar parameter warmup-period","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":null,"dir":"Reference","previous_headings":"","what":"Perform EM Algorithm on Pleiotropy — zero.centered.em","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"Fit two-component zero-mean Gaussian mixture sequence observed values","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"","code":"zero.centered.em(   values,   std.errors,   initial_slab_prob = 0.05,   initial_sigma1_squared = 0.1,   initial_sigma2_squared = 1e-04,   iters = 100,   optimizer = \"Brent\",   show_outputs = FALSE )"},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"values vector observations. initial_slab_prob initial value proportion slab (Gaussian component higher variance). Default .05. initial_sigma1_squared initial value variance slab component. Default .1. initial_sigma2_squared initial value variance spike component. Default .0001 iters number iterations EM algorithm. Default 100 optimizer method used Maximization Step. Must one \"Brent\", \"Nelder-Mead\" \"L-BFGS-B\". Default \"Brent\". show_outputs Whether included plot fitted density smoothed data density. Default FALSE. std.error standard error noise observations.","code":""},{"path":"https://ZixuanWu1.github.io/FLOW-MR/reference/zero.centered.em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Perform EM Algorithm on Pleiotropy — zero.centered.em","text":"list elements S1 standard deviation slab component S2 standard deviation spike component Pi proportion slab component","code":""}]
